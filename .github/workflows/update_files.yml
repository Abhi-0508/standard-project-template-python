name: Update README and LICENSE

# ğŸš€ Trigger: Run this workflow on any push to the main branch
on:
  push:
    branches:
      - main
    
jobs:
  update-files:
    # ğŸ–¥ï¸ Define the runner environment
    runs-on: ubuntu-latest
    
    steps:
      # ğŸ“¥ Step 1: Checkout the repository code to the runner
      - name: Checkout code
        uses: actions/checkout@v4

      # ğŸ“ Step 2: Search for placeholders and replace them if found    
      - name: Replace Placeholders
        run: |
          if grep -q '<<REPO_NAME>>' README.md; then
            # Replacing placeholders found
            repo_name=$(basename $GITHUB_REPOSITORY)
            year=$(date +'%Y')
            author="Abhishek Radhakrishnan"

            # ğŸ§© Replace placeholders with actual values
            sed -i "s/<<REPO_NAME>>/$repo_name/g" README.md
            sed -i "s/<<YEAR>>/$year/g" LICENSE
            sed -i "s/<<AUTHOR>>/$author/g" LICENSE
          else
            # âœ… Placeholders not found, skipping replacement
            echo "Placeholders not found."

      # ğŸ’¾ Step 3: Commit the changes made by placeholder replacement
      - name: Commit changes
        run: |
          git config --global user.name 'my-automation-actions[bot]'
          git config --global user.email 'my-automation-actions[bot]@noreply.com'

          # ğŸ“¦ Commit and push the changes back to the repository
          git commit -m "Auto-update README and LICENSE files with repository name, year and author information"
          git push
